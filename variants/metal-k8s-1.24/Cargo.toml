[package]
# This is the metal-k8s-1.24 variant.  "." is not allowed in crate names, but
# we don't use this crate name anywhere.
name = "metal-k8s-1_24"
version = "0.1.0"
edition = "2018"
publish = false
build = "build.rs"
# Don't rebuild crate just because of changes to README.
exclude = ["README.md"]

[package.metadata.build-variant.image-layout]
os-image-size-gib = 4
partition-plan = "unified"

[package.metadata.build-variant.image-features]
grub-set-private-var = true

[package.metadata.build-variant]
image-format = "raw"
supported-arches = ["x86_64"]
included-packages = [
# core
    "kernel-5.15",
    "release",
# networking
    "wicked",
# k8s
    "cni",
    "cni-plugins",
    "kubelet-1.24",
]
kernel-parameters = [
    # Only reserve if there are at least 2GB
    "crashkernel=2G-:256M"
]

[lib]
path = "lib.rs"

[build-dependencies]
# core
kernel-5_15 = { path = "../../packages/kernel-5.15" }
release = { path = "../../packages/release" }
# networking
wicked = { path = "../../packages/wicked" }
# k8s
cni = { path = "../../packages/cni" }
cni-plugins = { path = "../../packages/cni-plugins" }
kubernetes-1_24 = { path = "../../packages/kubernetes-1.24" }

